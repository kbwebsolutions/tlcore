define(["jquery","core/notification"],function(a,b){return{restUrl:null,setRestURL:function(a){this.restUrl=a},call:function(c,d,e,f,g){this.restUrl||b.alert("Coding issue: Rest URL has not been set"),d||(d={}),d.action=c;var h=function(){var a=M.cfg.wwwroot+"/login",c='It appears that you are not logged in. Please <a target="_blank" href="'+a+'">log in</a> to continue';b.alert("Not logged in",c,"OK")},i=function(a){g&&g.removeOverlay(),a||(a={status:"jqXHR object invalid",responseText:""}),window.console.error("error - jqXHR",a);var c,d,e;if(a.responseJSON?(c=a.responseJSON.error,d=a.responseJSON.errorcode,e=a.responseJSON.stacktrace):(c="Unknown error",d="unknown",e="unknown - possible bad JSON? "+a.responseText),a.responseJSON&&a.responseJSON.errorcode&&"requireloginerror"===a.responseJSON.errorcode)return h();var f='<div class="ajaxErrors"><div class="ajaxErrorMsg">'+c+'</div><div class="ajaxErrorStatus">Error status code: '+a.status+'</div><div class="ajaxErrorCode">Error code: '+d+'</div><div class="ajaxErrorStackTrace">Stack trace: '+e+"</div></div>";b.alert("An error has occurred",f,"OK")},j=function(a){if("function"==typeof f){if(f(a))return;i(a)}};return a.ajax({url:this.restUrl,data:d,method:e,error:j}).then(function(a){return g&&g.removeOverlay(),a})},get:function(a,b,c,d){return this.call(a,b,"GET",c,d)},post:function(a,b,c,d){return this.call(a,b,"POST",c,d)},put:function(a,b,c,d){return this.call(a,b,"PUT",c,d)},patch:function(a,b,c,d){return this.call(a,b,"PATCH",c,d)},"delete":function(a,b,c,d){return this.call(a,b,"DELETE",c,d)}}});